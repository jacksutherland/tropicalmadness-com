dom.addEventListener("click",document.querySelectorAll("header .mobile-menu-trigger, header nav .menu-closed"),(function(e){var n=document.getElementById("main-menu");n.classList.toggle("mobile-nav"),n.classList.toggle("open")}));querySelector('#locations-ul li[data-slug="'+o.slug+'"] [data-zoom]').addEventListener("click",function(o){o.preventDefault(),locations.zoomIn(this.marker)}.bind({marker:o.marker}))}))}),!0)}ux.spa.init({template:"/locations/location-list",container:"#locations-ul",url:e,param:"region",changed:function(o){document.getElementById("location-regions").value=o,document.getElementById("locations-radius").style.display="none",document.getElementById("locations-address").value="",locations.reload()}}),locations.init(o),document.getElementById("location-regions").addEventListener("change",(function(){document.getElementById("locations-radius").style.display="none",document.getElementById("locations-address").value="",ux.spa.update("region",document.getElementById("location-regions").value,(function(){locations.reload()}))})),document.getElementById("locations-radius").addEventListener("change",(function(){locations.changeRadius(parseInt(this.value),(function(o,e){n(o,e)}))})),document.getElementById("locations-address").addEventListener("change",(function(){document.getElementById("location-regions").value="";var o=this.value;""==o.trim()?document.getElementById("locations-radius").style.display="none":(document.querySelector("#locations-radius option[data-default]").setAttribute("selected","selected"),document.getElementById("locations-radius").style.display="inline-block",locations.changeAddress(o,parseInt(document.getElementById("locations-radius").value),(function(o,e){n(o,e)})))}))},locations={inited:!1,apiKey:null,map:null,geocoder:null,infoWindow:null,bounds:null,data:null,markers:[],address:"",elements:{attrselector:"",map:null,results:null},init:function(o){locations.elements.attrselector="[data-json]",locations.elements.map=document.getElementById("locations-map"),locations.elements.results=document.getElementById("location-results"),locations.apiKey=o;var e=document.createElement("script");e.src="//maps.googleapis.com/maps/api/js?key="+locations.apiKey+"&callback=locations.initMap",document.body.appendChild(e)},reload:function(){var o=[],e=document.querySelectorAll(locations.elements.attrselector);0==e.length?locations.clearMap():(dom.each(e,(function(){var e=JSON.parse(this.dataset.json);e.element=this,o.push(e)})),locations.inited||(locations.inited=!0,locations.data=o),locations.loadMap(o).forEach((function(o,e){o.element.querySelector("[data-zoom]").addEventListener("click",(function(e){e.preventDefault(),locations.zoomIn(o.marker)}))})))},zoomIn:function(o){locations.map.setZoom(15),locations.map.panTo(o.position)},initMap:function(){locations.map=new google.maps.Map(locations.elements.map,{mapTypeId:"roadmap",minZoom:2,maxZoom:15}),locations.map.setTilt(45),locations.infoWindow=new google.maps.InfoWindow,locations.geocoder=new google.maps.Geocoder,locations.reload()},changeRadius:function(o,e){locations.changeAddress(locations.address,o,(function(o,n){"function"==typeof e&&e(o,n)}))},changeAddress:function(o,e,n){locations.address=o,locations.geocoder.geocode({address:locations.address},(function(o,t){if("ZERO_RESULTS"==t)locations.clearMap(),"function"==typeof n&&n([],[]);else if(t==google.maps.GeocoderStatus.OK){var a=o[0].geometry.location,s=[],l=locations.data.length,i=[],c=[];locations.data.forEach((function(o,n){if("object"==typeof o.geometry){var t=locations.degrees_to_radians(o.geometry.lat()),d=locations.degrees_to_radians(o.geometry.lng()),r=locations.degrees_to_radians(a.lat()),u=locations.degrees_to_radians(a.lng());3959*Math.acos(Math.cos(r)*Math.cos(t)*Math.cos(d-u)+Math.sin(r)*Math.sin(t))<e&&(s.push(o),i.push(o.slug))}--l||(c=locations.loadMap(s))})),"function"==typeof n&&n(i,c)}else console.log("Geocoder Error: "+t),locations.clearMap()}))},loadMap:function(o){location.bounds=new google.maps.LatLngBounds;if(o.length>0)for(var e=0;e<o.length;e++)null==o[e].geometry?setTimeout(locations.geocodeLocation.bind(null,o[e],o.length,e,(function(e,n,t){"OK"===e&&(o[n].geometry=t,o[n].marker=locations.addLocation(o[n],o.length))})),0*e):o[e].marker=locations.addLocation(o[e],o.length);return o},degrees_to_radians:function(o){return o*(Math.PI/180)},geocodeLocation:function(o,e,n,t){o.mappableAddress.trim().length>0?locations.geocoder.geocode({address:o.mappableAddress},(function(o,e){"OK"===e?t(e,n,o[0].geometry.location):(console.log("Geocode was not successful for the following reason: "+e),t(e,n))})):t("NO-ADDRESS",n)},clearMap:function(){for(i=0;i<locations.markers.length;i++)locations.markers[i].setMap(null);locations.markers=[],locations.map.setZoom(2)},addLocation:function(o,e){var n=new google.maps.Marker({map:locations.map,position:o.geometry}),t="<a style='font-weight:700;margin:0 0 2px 0;' href='"+o.url+"'>"+o.name+"</a>";return""!=o.displayAddress&&(t+="<br/>"+o.displayAddress.replace(/[~]/g,"<br>")),google.maps.event.addListener(n,"click",(function(){locations.infoWindow.setContent(t),locations.infoWindow.open(locations.map,n)})),locations.markers.push(n),location.bounds.extend(o.geometry),locations.map.fitBounds(location.bounds),n}};